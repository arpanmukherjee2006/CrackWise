<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Materials - CrackWise</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="study-styles.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>Loading Study Materials...</p>
    </div>

    <header class="navbar">
        <div class="nav-left">
            <a class="brand" href="index.html">CrackWise</a>
        </div>
        <div class="nav-center">
            <input id="search-input" class="search" type="text" placeholder="Search chapters..." aria-label="Search chapters" />
        </div>
        <div class="nav-right">
            <button id="mobile-search-btn" class="icon-btn show-sm" aria-label="Open search" title="Search">üîç</button>
            <div id="auth-buttons" class="auth-buttons">
                <button id="login-button" class="btn btn-primary">Login</button>
            </div>
            <div id="user-menu" class="user-menu hidden">
                <div class="profile-dropdown">
                    <button id="profile-btn" class="profile-btn" aria-label="User profile menu">
                        <div class="profile-avatar">
                            <span id="user-initial">U</span>
                        </div>
                        <span id="user-greeting" class="user-greeting"></span>
                        <svg class="dropdown-arrow" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M6 8L2 4h8L6 8z"/>
                        </svg>
                    </button>
                    <div id="profile-dropdown" class="profile-dropdown-menu hidden">
                        <button id="set-password-btn" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1L5 4h2v4H3V6L0 9l3 3v-2h4v4H5l3 3 3-3h-2v-4h4v2l3-3-3-3v2H9V4h2L8 1z"/>
                            </svg>
                            Set Password
                        </button>
                        <button id="logout-btn" class="dropdown-item logout-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M3 1h6v2H3v10h6v2H3a2 2 0 01-2-2V3a2 2 0 012-2zm8 4l3 3-3 3v-2H6V6h5V4z"/>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="mobile-search" class="mobile-search hidden">
        <input id="search-input-mobile" class="search" type="text" placeholder="Search chapters..." aria-label="Search chapters" />
    </div>

    <main class="study-main">
        <!-- Subject Selection -->
        <div class="subject-selector">
            <div class="subject-tabs">
                <button class="subject-tab active" data-subject="physics">üìö Physics</button>
                <button class="subject-tab" data-subject="chemistry">üß™ Chemistry</button>
                <button class="subject-tab" data-subject="mathematics" id="math-tab">üìê Mathematics</button>
            </div>
        </div>

        <!-- Study Navigation -->
        <nav class="study-nav">
            <div class="nav-header">
                <h2 id="subject-title">Physics Chapters</h2>
                <div class="progress-indicator">
                    <span id="completed-count">0</span>/<span id="total-count">6</span> Complete
                </div>
            </div>
            <ul class="chapter-list" id="chapter-list">
                <!-- Chapters will be dynamically loaded based on selected subject -->
            </ul>
        </nav>

        <!-- Study Content -->
        <div class="study-content">
            <div class="content-header">
                <h1 id="chapter-title">Select a Chapter</h1>
                <div class="content-tabs">
                    <button class="tab-btn active" data-tab="explanation">üìö Explanation</button>
                    <button class="tab-btn" data-tab="formulas">üìê Formulas</button>
                    <button class="tab-btn" data-tab="quiz">üß† Problems</button>
                </div>
            </div>

            <div class="tab-content">
                <!-- Explanation Tab -->
                <div id="explanation-tab" class="tab-panel active">
                    <div class="welcome-message">
                        <div class="welcome-icon">üìñ</div>
                        <h2>Welcome to JEE Physics Study</h2>
                        <p>Select a chapter from the left sidebar to start studying. Each chapter includes detailed explanations, key formulas, and practice questions.</p>
                        <div class="study-features">
                            <div class="feature-item">
                                <span class="feature-icon">‚ú®</span>
                                <span>Comprehensive explanations with examples</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üìä</span>
                                <span>All important formulas organized</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üéØ</span>
                                <span>practice questions per chapter</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üìà</span>
                                <span>Progress tracking and analytics</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Formulas Tab -->
                <div id="formulas-tab" class="tab-panel">
                    <div class="formulas-content">
                        <p class="tab-instruction">Select a chapter to view its formulas</p>
                    </div>
                </div>

                <!-- Quiz Tab -->
                <div id="quiz-tab" class="tab-panel">
                    <div class="quiz-content">
                        <p class="tab-instruction">Select a chapter to take its quiz</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="study-data.js" defer></script>
    <script src="chemistry-data.js" defer></script>
    <script src="mathematics-data.js" defer></script>
    <script src="neet-physics-data.js" defer></script>
    <script src="neet-chemistry-data.js" defer></script>
    <script src="neet-biology-data.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <script src="study-script.js" defer></script>
    <!-- Login Modal -->
    <dialog id="login-modal" class="modal">
        <div class="modal-content">
            <h2>Login to CrackWise</h2>
            <form id="login-form" class="auth-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" name="password" required>
                </div>
                <button type="submit" class="btn btn-primary w-full">Login</button>
                <button type="button" id="send-magic-btn" class="btn btn-outline w-full mt-2">Send Magic Link Instead</button>
                <div class="form-footer">
                    <p>Don't have an account? <a href="signup.html">Sign up</a></p>
                </div>
            </form>
        </div>
    </dialog>
    
    <!-- Password Set Modal for Magic Link Users -->
    <dialog id="set-password-modal" class="modal">
      <div class="modal-header">
        <h3>Set Your Password</h3>
        <button id="set-password-close" class="modal-close" aria-label="Close modal">&times;</button>
      </div>
      <div class="modal-body">
        <p>Create a password to easily log in next time without using a magic link.</p>
        <form id="set-password-form">
          <div class="field">
            <label for="new-password">Enter Password</label>
            <input type="password" id="new-password" required minlength="6">
          </div>
          <div class="field">
            <label for="confirm-password">Confirm Password</label>
            <input type="password" id="confirm-password" required minlength="6">
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Set Password</button>
            <button type="button" id="skip-password" class="btn btn-secondary">Skip for Now</button>
          </div>
        </form>
        <div id="set-password-error" class="error-message"></div>
      </div>
    </dialog>
</body>
</html>